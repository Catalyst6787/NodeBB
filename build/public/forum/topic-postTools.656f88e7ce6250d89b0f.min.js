"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,15794,21374,25432,34271,49897,57490,63154,99127],{8454:((B,S,o)=>{var R,P;R=[o(24962),o(96352),o(52473),o(17459),o(34342),o(49897),o(33530),o(29930),o(91749),o(30076)],P=(function(D,k,M,b,C,x,E,l,m,U){const T={};let c=!1;T.init=function(i){c=!1,y(),g(i),D.addShareHandlers(ajaxify.data.titleRaw),C.addVoteHandler(),T.updatePostCount(ajaxify.data.postcount)};function y(){document.querySelector('[component="topic"]')&&$('[component="topic"]').on("show.bs.dropdown",'[component="post/tools"]',function(){const a=$(this),s=a.find(".dropdown-menu"),{top:e}=this.getBoundingClientRect();if(a.toggleClass("dropup",e>window.innerHeight/2),s.attr("data-loaded"))return;s.html(U.generatePlaceholderWave([3,5,9,7,10,"divider",10]));const t=a.parents("[data-pid]"),n=t.attr("data-pid"),r=parseInt(t.attr("data-index"),10);socket.emit("posts.loadPostTools",{pid:n},async(d,A)=>{if(d)return l.error(d);A.posts.display_move_tools=A.posts.display_move_tools&&r!==0;const v=await app.parseAndTranslate("partials/topic/post-menu-list",A),I=o(57576);s.attr("data-loaded","true").html(v),new I("[data-clipboard-text]"),m.fire("action:post.tools.load",{element:s})})})}T.toggle=function(i,a){const s=M.get("post","pid",i);s.find('[component="post/quote"], [component="post/bookmark"], [component="post/reply"], [component="post/flag"], [component="user/chat"]').toggleClass("hidden",a),s.find('[component="post/delete"]').toggleClass("hidden",a).parent().attr("hidden",a?"":null),s.find('[component="post/restore"]').toggleClass("hidden",!a).parent().attr("hidden",a?null:""),s.find('[component="post/purge"]').toggleClass("hidden",!a).parent().attr("hidden",a?null:""),T.removeMenu(s)},T.removeMenu=function(i){i.find('[component="post/tools"] .dropdown-menu').removeAttr("data-loaded").html("")},T.updatePostCount=function(i){M.get("topic/post-count").attr("title",i).html(U.humanReadableNumber(i)),k.setCount(i)};function g(i){const a=M.get("topic");J(),a.on("click",'[component="post/quote"]',function(){h($(this),i)}),a.on("click",'[component="post/reply"]',function(){u($(this),i)}),$(".topic").on("click",'[component="topic/reply"]',function(e){e.preventDefault(),u($(this),i)}),$(".topic").on("click",'[component="topic/reply-as-topic"]',function(){b.translate(`[[topic:link-back, ${ajaxify.data.titleRaw}, ${config.relative_path}/topic/${ajaxify.data.slug}]]`,function(e){m.fire("action:composer.topic.new",{cid:ajaxify.data.cid,body:e})})}),a.on("click",'[component="post/bookmark"]',function(){return p($(this),f($(this),"data-pid"))}),a.on("click",'[component="post/upvote"]',function(){return C.toggleVote($(this),".upvoted",1)}),a.on("click",'[component="post/downvote"]',function(){return C.toggleVote($(this),".downvoted",-1)}),a.on("click",'[component="post/vote-count"]',function(){C.showVotes(f($(this),"data-pid"))}),a.on("click",'[component="post/announce-count"]',function(){C.showAnnouncers(f($(this),"data-pid"))}),a.on("click",'[component="post/flag"]',function(){const e=f($(this),"data-pid");o.e(6574).then(function(){var t=[o(6574)];(function(n){n.showFlagModal({type:"post",id:e})}).apply(null,t)}).catch(o.oe)}),a.on("click",'[component="post/already-flagged"]',function(){const e=$(this).data("flag-id");o.e(6574).then(function(){var t=[o(6574)];(function(n){E.confirm("[[flags:modal-confirm-rescind]]",function(r){r&&n.rescind(e)})}).apply(null,t)}).catch(o.oe)}),a.on("click",'[component="post/flagUser"]',function(){const e=f($(this),"data-uid");o.e(6574).then(function(){var t=[o(6574)];(function(n){n.showFlagModal({type:"user",id:e})}).apply(null,t)}).catch(o.oe)}),a.on("click",'[component="post/flagResolve"]',function(){const e=$(this).attr("data-flagId");o.e(6574).then(function(){var t=[o(6574)];(function(n){n.resolve(e)}).apply(null,t)}).catch(o.oe)}),a.on("click",'[component="post/edit"]',function(){const e=$(this),t=parseInt(f(e,"data-timestamp"),10),n=parseInt(ajaxify.data.postEditDuration,10);s(n,t,"post-edit-duration-expired")&&m.fire("action:composer.post.edit",{pid:f(e,"data-pid")})}),config.enablePostHistory&&ajaxify.data.privileges["posts:history"]&&a.on("click",'[component="post/view-history"], [component="post/edit-indicator"]',function(){const e=$(this);o.e(92747).then(function(){var t=[o(92747)];(function(n){n.open(f(e,"data-pid"))}).apply(null,t)}).catch(o.oe)}),a.on("click",'[component="post/delete"]',function(){const e=$(this),t=parseInt(f(e,"data-timestamp"),10),n=parseInt(ajaxify.data.postDeleteDuration,10);s(n,t,"post-delete-duration-expired")&&N($(this))});function s(e,t,n){if(!ajaxify.data.privileges.isAdminOrMod&&e&&Date.now()-t>e*1e3){const r=Math.floor(e/86400),d=Math.floor(e%86400/3600),A=Math.floor(e%86400%3600/60),v=e%86400%3600%60;let I="[[error:"+n+", "+e+"]]";return r?d?I="[[error:"+n+"-days-hours, "+r+", "+d+"]]":I="[[error:"+n+"-days, "+r+"]]":d?A?I="[[error:"+n+"-hours-minutes, "+d+", "+A+"]]":I="[[error:"+n+"-hours, "+d+"]]":A&&(v?I="[[error:"+n+"-minutes-seconds, "+A+", "+v+"]]":I="[[error:"+n+"-minutes, "+A+"]]"),l.error(I),!1}return!0}a.on("click",'[component="post/restore"]',function(){N($(this))}),a.on("click",'[component="post/purge"]',function(){K($(this))}),a.on("click",'[component="post/move"]',function(){const e=$(this);o.e(90677).then(function(){var t=[o(90677)];(function(n){n.init(e.parents("[data-pid]"))}).apply(null,t)}).catch(o.oe)}),a.on("click",'[component="post/change-owner"]',function(){const e=$(this);Promise.all([o.e(20056),o.e(17205)]).then(function(){var t=[o(17205)];(function(n){n.init(e.parents("[data-pid]"))}).apply(null,t)}).catch(o.oe)}),a.on("click",'[component="post/manage-editors"]',function(){const e=$(this);Promise.all([o.e(20056),o.e(24459)]).then(function(){var t=[o(24459)];(function(n){n.init(e.parents("[data-pid]"))}).apply(null,t)}).catch(o.oe)}),a.on("click",'[component="post/ban-ip"]',function(){const e=$(this).attr("data-ip");socket.emit("blacklist.addRule",e,function(t){if(t)return l.error(t);l.success("[[admin/manage/blacklist:ban-ip]]")})}),a.on("click",'[component="post/chat"]',function(){Y($(this))})}async function u(i,a){const s=await w();F(async function(){let e=await W(i);(f(i,"data-uid")==="0"||!f(i,"data-userslug"))&&(e="");const t=i.is('[component="post/reply"]')?f(i,"data-pid"):null,n=!t||!s.pid||t===s.pid;s.text&&n?(e=e||s.username,m.fire("action:composer.addQuote",{tid:a,pid:t,title:ajaxify.data.titleRaw,username:e,body:s.text,selectedPid:s.pid})):m.fire("action:composer.post.new",{tid:a,pid:t,title:ajaxify.data.titleRaw,body:e?e+" ":$('[component="topic/quickreply/text"]').val()||""})})}async function h(i,a){const s=await w();F(async function(){const e=await W(i),t=f(i,"data-pid");function n(d){m.fire("action:composer.addQuote",{tid:a,pid:t,username:e,title:ajaxify.data.titleRaw,text:d})}if(s.text&&t&&t===s.pid)return n(s.text);const{content:r}=await x.get(`/posts/${encodeURIComponent(t)}/raw`);n(r)})}async function w(){let i="",a,s="";const e=window.getSelection?window.getSelection():document.selection.createRange(),t=$('[component="post"] [component="post/content"]');let n;return t.each(function(r,d){e&&e.containsNode&&d&&e.containsNode(d,!0)&&(n=d)}),n&&e&&(i=e.toString(),a=$(n).parents('[component="post"]').attr("data-pid"),s=await W($(n))),{text:i,pid:a,username:s}}function p(i,a){const s=i.attr("data-bookmarked")==="false"?"put":"del";return x[s](`/posts/${encodeURIComponent(a)}/bookmark`,void 0,function(e){if(e)return l.error(e);const t=s==="put"?"bookmark":"unbookmark";m.fire(`action:post.${t}`,{pid:a})}),!1}function f(i,a){return i.parents("[data-pid]").attr(a)}function W(i){return new Promise(a=>{let s="";if(i.attr("component")==="topic/reply"){a(s);return}const e=i.parents("[data-pid]");if(e.length&&!e.hasClass("self-post")){Promise.all([o.e(53050),o.e(26174)]).then(function(){var t=[o(13230)];(function(n){s=n(e.attr("data-username"),!0),s||(e.attr("data-uid")!=="0"?s="[[global:former-user]]":s="[[global:guest]]"),s&&s!=="[[global:former-user]]"&&s!=="[[global:guest]]"&&(s="@"+s),a(s)}).apply(null,t)}).catch(o.oe);return}a(s)})}function N(i){const a=f(i,"data-pid"),e=M.get("post","pid",a).hasClass("deleted")?"restore":"delete";V(e,a)}function K(i){V("purge",f(i,"data-pid"))}async function V(i,a){({action:i}=await m.fire(`static:post.${i}`,{action:i,pid:a})),i&&E.confirm("[[topic:post-"+i+"-confirm]]",function(s){if(!s)return;const e=i==="purge"?"":"/state";x[i==="restore"?"put":"del"](`/posts/${encodeURIComponent(a)}${e}`).catch(l.error)})}function Y(i){const a=i.parents("[data-pid]");return o.e(92619).then(function(){var s=[o(92619)];(function(e){e.newChat(a.attr("data-uid"))}).apply(null,s)}).catch(o.oe),i.parents(".btn-group").find(".dropdown-toggle").click(),!1}function F(i){if(!parseInt(ajaxify.data.topicStaleDays,10))return i();const s=Math.min(Date.now()-1e3*60*60*24*ajaxify.data.topicStaleDays,864e13);if(c||ajaxify.data.lastposttime>=s)return i();E.dialog({title:"[[topic:stale.title]]",message:"[[topic:stale.warning]]",buttons:{reply:{label:"[[topic:stale.reply-anyway]]",className:"btn-link",callback:function(){c=!0,i()}},create:{label:"[[topic:stale.create]]",className:"btn-primary",callback:function(){b.translate(`[[topic:link-back, ${ajaxify.data.title}, ${config.relative_path}/topic/${ajaxify.data.slug}]]`,function(t){m.fire("action:composer.topic.new",{cid:ajaxify.data.cid,body:t,fromStaleTopic:!0})})}}}}).modal()}const z=utils.debounce(O,250);function J(){ajaxify.data.privileges["topics:reply"]&&(m.onPage("action:posts.loaded",G),$(document).off("selectionchange"),$(document).on("selectionchange",function(){window.getSelection().toString()===""&&$('[component="selection/tooltip"]').addClass("hidden")}),$(document).on("selectionchange",z))}function O(){window.getSelection().toString()===""||G()}async function G(){let i=$('[component="selection/tooltip"]');if(i.addClass("hidden"),i.attr("data-ajaxify")==="1"){i.remove();return}const a=window.getSelection();if(a.focusNode&&a.type==="Range"&&ajaxify.data.template.topic){const s=$(a.focusNode),e=$(a.anchorNode),t=e.parents("[data-pid]").attr("data-pid"),n=s.parents("[data-pid]").attr("data-pid");if(t!==n||!s.parents('[component="post/content"]').length||!e.parents('[component="post/content"]').length)return;const r=s.parents("[data-pid]"),d=a.getRangeAt(0);if(!r.length||d.collapsed)return;const A=d.getClientRects(),v=A[A.length-1];i.length||(i=await app.parseAndTranslate("partials/topic/selection-tooltip",ajaxify.data),$('[component="selection/tooltip"]').remove(),i.addClass("hidden").appendTo("body")),i.off("click").on("click",'[component="selection/tooltip/quote"]',function(){i.addClass("hidden"),h(r.find('[component="post/quote"]'),ajaxify.data.tid)}),i.removeClass("hidden"),$(window).one("action:ajaxify.start",function(){i.attr("data-ajaxify",1).addClass("hidden"),$(document).off("selectionchange",z)});const I=i.outerWidth(!0);i.css({top:v.bottom+$(window).scrollTop(),left:I>v.width?v.left:v.left+v.width-I})}}return T}).apply(S,R),P!==void 0&&(B.exports=P)}),24962:((B,S,o)=>{var R,P;R=[o(91749)],P=(function(D){const k={},M=window.location.protocol+"//"+window.location.host;k.addShareHandlers=function(x){function E(l,m,U,T){return window.open(l,"_blank","width="+U+",height="+T+",scrollbars=no,status=no"),D.fire("action:share.open",{url:l,urlToPost:m}),!1}$("#content").off("shown.bs.dropdown",".share-dropdown").on("shown.bs.dropdown",".share-dropdown",function(){const l=$(this).find(".post-link");l.val(M+C($(this))),setTimeout(function(){l.putCursorAtEnd().select()},50)}),b(".post-link",function(l){return l.preventDefault(),!1}),b('[component="share/twitter"]',function(){const l=C($(this)),m=`https://twitter.com/intent/tweet?text=${encodeURIComponent(x)}&url=${encodeURIComponent(l)}`;return E(m,l,550,420)}),b('[component="share/facebook"]',function(){const l=C($(this)),m=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(l)}`;return E(m,l,626,436)}),b('[component="share/whatsapp"]',function(){const l=C($(this)),m=encodeURIComponent(x)+" - "+encodeURIComponent(l),U=config.useragent.isMobile?`whatsapp://send?text=${m}`:`https://wa.me/?text=${m}`;return E(U,l,626,436)}),b('[component="share/telegram"]',function(){const l=C($(this)),m=`https://t.me/share/url?text=${encodeURIComponent(x)}&url=${encodeURIComponent(l)}`;return E(m,l,626,436)}),b('[component="share/linkedin"]',function(){const l=C($(this)),m=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(l)}`;return E(m,l,626,436)}),D.fire("action:share.addHandlers",{openShare:E})};function b(x,E){$("#content").off("click",x).on("click",x,E)}function C(x){const E=parseInt(x.parents("[data-pid]").attr("data-pid"),10),l="/post"+(E?"/"+E:"");return M+config.relative_path+l}return k}).apply(S,R),P!==void 0&&(B.exports=P)}),29869:(B=>{B.exports=function(S,o,R){o.setGlobal("true",!0),o.setGlobal("false",!1);const P=1440*60*1e3,D={displayMenuItem:M,buildMetaTag:b,buildLinkTag:C,stringify:x,escape:E,stripTags:l,buildCategoryIcon:m,buildCategoryLabel:U,generateCategoryBackground:T,generateChildrenCategories:c,generateTopicClass:y,membershipBtn:g,spawnPrivilegeStates:u,localeToHTML:h,renderTopicImage:w,renderDigestAvatar:p,userAgentIcons:f,buildAvatar:W,increment:N,generateWroteReplied:K,generateRepliedTo:V,generateWrote:Y,encodeURIComponent:F,isoTimeToLocaleString:z,shouldHideReplyContainer:J,humanReadableNumber:O,formattedNumber:G,txEscape:i,uploadBasename:a,generatePlaceholderWave:s,register:e,__escape:k};function k(t){return t}function M(t,n){const r=t.navigation[n];return!(!r||r.route.match("/users")&&t.user&&!t.user.privileges["view:users"]||r.route.match("/tags")&&t.user&&!t.user.privileges["view:tags"]||r.route.match("/groups")&&t.user&&!t.user.privileges["view:groups"])}function b(t){const n=t.name?'name="'+t.name+'" ':"",r=t.property?'property="'+t.property+'" ':"",d=t.content?'content="'+t.content.replace(/\n/g," ")+'" ':"";return"<meta "+n+r+d+`/>
	`}function C(t){const n=["link","rel","as","type","href","sizes","title","crossorigin"],[r,d,A,v,I,Q,H,L]=n.map(j=>t[j]?`${j}="${t[j]}" `:"");return"<link "+r+d+A+v+Q+H+I+L+`/>
	`}function x(t){return JSON.stringify(t).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function E(t){return S.escapeHTML(t)}function l(t){return S.stripHTMLTags(t)}function m(t,n,r){return t?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${r}" style="${T(t)} width:${n}; height: ${n}; font-size: ${parseInt(n,10)/2}px;">${t.icon?`<i class="fa fa-fw ${t.icon}"></i>`:""}</span>`:""}function U(t,n="a",r=""){if(!t)return"";const d=n==="a"?`href="${R}/category/${t.slug}"`:"";return`<${n} ${d} class="badge px-1 text-truncate text-decoration-none ${r}" style="color: ${t.color};background-color: ${t.bgColor};border-color: ${t.bgColor}!important; max-width: 70vw;">
			${t.icon&&t.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${t.icon}"></i>`:""}
			${t.name}
		</${n}>`}function T(t){if(!t)return"";const n=[];return t.bgColor&&(n.push("background-color: "+t.bgColor),n.push(`border-color: ${t.bgColor}!important`)),t.color&&n.push("color: "+t.color),t.backgroundImage&&(n.push("background-image: url("+t.backgroundImage+")"),t.imageClass&&n.push("background-size: "+t.imageClass)),n.join("; ")+";"}function c(t){let n="";return!t||!t.children||!t.children.length||(t.children.forEach(function(r){if(r&&!r.isSection){const d=r.link?r.link:R+"/category/"+r.slug;n+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+T(r)+'"><i class="fa fa-fw '+r.icon+'"></i></div><a href="'+d+'"><small>'+r.name+"</small></a></span>"}}),n=n&&'<span class="category-children">'+n+"</span>"),n}function y(t){return["locked","pinned","deleted","unread","scheduled"].filter(r=>!!t[r]).join(" ")}function g(t,n=""){return t.isMember&&t.name!=="administrators"?`<button class="btn btn-danger ${n}" data-action="leave" data-group="${t.displayName}" ${t.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:t.isPending&&t.name!=="administrators"?`<button class="btn btn-warning disabled ${n}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:t.isInvited?`<button class="btn btn-warning" data-action="rejectInvite" data-group="${t.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${t.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!t.disableJoinRequests&&t.name!=="administrators"?`<button class="btn btn-success ${n}" data-action="join" data-group="${t.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function u(t,n,r,d){const A=[];for(const[v,I]of Object.entries(r))A.push({name:v,state:I,type:d[v]});return A.map(function(v){const I=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],Q=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],H=["groups:moderate"];let L=["groups:view:users","groups:find","groups:read","groups:topics:read","groups:topics:create","groups:topics:reply","groups:topics:tag","groups:posts:edit","groups:posts:history","groups:posts:delete","groups:posts:upvote","groups:posts:downvote","groups:topics:delete"];t===-1&&(L=L.slice(3));const j=n==="guests"&&(I.includes(v.name)||v.name.startsWith("groups:admin:"))||n==="spiders"&&!Q.includes(v.name)||n==="fediverse"&&!L.includes(v.name)||n==="Global Moderators"&&H.includes(v.name);return`
				<td data-privilege="${v.name}" data-value="${v.state}" data-type="${v.type}">
					<div class="form-check text-center">
						<input class="form-check-input float-none${j?' d-none"':""}" autocomplete="off" type="checkbox"${v.state?" checked":""}${j?' disabled="disabled" aria-diabled="true"':""} />
					</div>
				</td>
			`}).join("")}function h(t,n){return t=t||n||"en-GB",t.replace("_","-")}function w(t){return t.thumb?'<img src="'+t.thumb+'" class="img-circle user-img" title="'+t.user.displayname+'" />':'<img component="user/picture" data-uid="'+t.user.uid+'" src="'+t.user.picture+'" class="user-img" title="'+t.user.displayname+'" />'}function p(t){return t.teaser?t.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+t.teaser.user.picture+'" title="'+t.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+t.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+t.teaser.user["icon:text"]+"</div>":t.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+t.user.picture+'" title="'+t.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+t.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+t.user["icon:text"]+"</div>"}function f(t){let n="";switch(t.platform){case"Linux":n+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":n+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":n+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":n+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":n+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":n+='<i class="fa fa-fw fa-mobile"></i>';break;default:n+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(t.browser){case"Chrome":n+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":n+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":n+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":n+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":n+='<i class="fa fa-fw fa-edge"></i>';break;default:n+='<i class="fa fa-fw fa-question-circle"></i>';break}return n}function W(t,n,r,d,A){t||(t=this),d=d||"";const v=new Map([["title",t.displayname],["data-uid",t.uid],["class",`avatar ${d}${r?" avatar-rounded":""}`]]),I=[`--avatar-size: ${n};`],Q=L=>Array.from(L).reduce((j,[X,Z])=>(j+=` ${X}="${Z}"`,j),"");let H="";return t.picture&&(H+=`<img${Q(v)} alt="${t.displayname}" loading="lazy" component="${A||"avatar/picture"}" src="${t.picture}" style="${I.join(" ")}" onError="this.remove()" itemprop="image" />`),H+=`<span${Q(v)} component="${A||"avatar/icon"}" style="${I.join(" ")} background-color: ${t["icon:bgColor"]}">${t["icon:text"]}</span>`,H}function N(t,n){return String(t+parseInt(n,10))}function K(t,n){return t.toPid?V(t,n):Y(t,n)}function V(t,n){const r=t.parent&&t.parent.displayname?t.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${t.timestamp<Date.now()-n*P?"on":"ago"}, ${t.toPid}, ${R}/post/${encodeURIComponent(t.toPid)}, ${r}, ${R}/post/${encodeURIComponent(t.pid)}, ${t.timestampISO}]]`}function Y(t,n){return`[[topic:wrote-${t.timestamp<Date.now()-n*P?"on":"ago"}, ${R}/post/${encodeURIComponent(t.pid)}, ${t.timestampISO}]]`}function F(t){return encodeURIComponent(t)}function z(t,n="en-GB"){return new Date(t).toLocaleString([n],{dateStyle:"short",timeStyle:"short"}).replace(/,/g,"&#44;")}function J(t){return!!(t.replies.count<=0||t.replies.hasSingleImmediateReply)}function O(t,n=1){return S.makeNumberHumanReadable(t,n)}function G(t){return S.addCommas(t)}function i(t){return String(t).replace(/%/g,"&#37;").replace(/,/g,"&#44;")}function a(t,n="/"){const r=/^\d+-/,d=t.substr(t.lastIndexOf(n)+1);return r.test(d)?d.slice(14):d}function s(t){return t.map(r=>r==="divider"?'<li class="dropdown-divider"></li>':`
			<li class="dropdown-item placeholder-wave">
				<div class="placeholder" style="width: 20px;"></div>
				<div class="placeholder col-${r}"></div>
			</li>`).join("")}function e(){Object.keys(D).forEach(function(t){o.registerHelper(t,D[t])})}return D}}),30076:((B,S,o)=>{var R,P;const D=o(29869);R=[o(77918),o(81335)],P=(function(k,M){return D(k,M,config.relative_path)}).apply(S,R),P!==void 0&&(B.exports=P)}),34342:((B,S,o)=>{var R,P;R=[o(52473),o(17459),o(49897),o(91749),o(33530),o(29930),o(89336)],P=(function(D,k,M,b,C,x,E){const l={};let m={};l.addVoteHandler=function(){m={},U()&&(D.get("topic").on("mouseenter",'[data-pid] [component="post/vote-count"]',y),D.get("topic").on("mouseleave",'[data-pid] [component="post/vote-count"]',c)),D.get("topic").on("mouseenter",'[data-pid] [component="post/announce-count"]',y),D.get("topic").on("mouseleave",'[data-pid] [component="post/announce-count"]',c)};function U(){const{upvoteVisibility:u,privileges:h}=ajaxify.data;return h.isAdminOrMod||u==="all"||u==="loggedin"&&config.loggedIn}function T(){const{upvoteVisibility:u,downvoteVisibility:h,privileges:w}=ajaxify.data;return w.isAdminOrMod||u==="all"||h==="all"||(u==="loggedin"||h==="loggedin")&&config.loggedIn}function c(){const u=$(this),h=u.parents("[data-pid]").attr("data-pid"),w=E.Tooltip.getInstance(this);w&&(w.dispose(),u.attr("title","")),m[h]=!1}function y(){const u=$(this),w=u.parent().parents("[data-pid]").attr("data-pid");m[w]=!0;const p=E.Tooltip.getInstance(this);p&&(p.dispose(),u.attr("title",""));const f=u.attr("component")==="post/vote-count"?`/posts/${encodeURIComponent(w)}/upvoters`:`/posts/${encodeURIComponent(w)}/announcers/tooltip`;M.get(f,{},function(W,N){if(W)return x.error(W);m[w]&&N&&g(u,N)})}function g(u,h){function w(f){u.attr("title",f),new E.Tooltip(u,{container:"#content",html:!0}).show()}let p=h.usernames.filter(f=>f!=="[[global:former-user]]");p.length&&(p.length+h.otherCount>h.cutoff?(p=p.join(", ").replace(/,/g,"|"),k.translate("[[topic:users-and-others, "+p+", "+h.otherCount+"]]",function(f){f=f.replace(/\|/g,","),w(f)})):(p=p.join(", "),w(p)))}return l.toggleVote=function(u,h,w){const p=u.closest("[data-pid]"),W=p.find(h).length?"del":"put",N=p.attr("data-pid");return M[W](`/posts/${encodeURIComponent(N)}/vote`,{delta:w},function(K){if(K){if(!app.user.uid){ajaxify.go("login");return}return x.error(K)}b.fire("action:post.toggleVote",{pid:N,delta:w,unvote:W==="del"})}),!1},l.showVotes=function(u){T()&&M.get(`/posts/${encodeURIComponent(u)}/voters`,{},function(h,w){if(h)return x.error(h);app.parseAndTranslate("modals/votes",w,function(p){const f=C.dialog({title:"[[global:voters]]",message:p,className:"vote-modal",show:!0,onEscape:!0,backdrop:!0});f.on("click",function(){f.modal("hide")})})})},l.showAnnouncers=async function(u){const h=await M.get(`/posts/${encodeURIComponent(u)}/announcers`,{}).catch(f=>x.error(f)),w=await app.parseAndTranslate("modals/announcers",h),p=C.dialog({title:`[[topic:announcers-x, ${h.announceCount}]]`,message:w,className:"announce-modal",show:!0,onEscape:!0,backdrop:!0});p.on("click",function(){p.modal("hide")})},l}).apply(S,R),P!==void 0&&(B.exports=P)}),49897:((B,S,o)=>{o.r(S),o.d(S,{del:()=>T,get:()=>x,head:()=>E,patch:()=>m,post:()=>l,put:()=>U});var R=o(91749),P=o.n(R),D=o(33530),k=o.n(D);const M=config.relative_path+"/api/v3";async function b(c,y){if(c.url=c.url.startsWith("/api")?config.relative_path+c.url:M+c.url,typeof y=="function"){C(c).then(g=>y(null,g),g=>y(g));return}try{return await C(c)}catch(g){if(g.message==="A valid login session was not found. Please log in and try again."){const{url:u}=await(0,R.fire)("filter:admin.reauth",{url:"login"});return(0,D.confirm)("[[error:api.reauth-required]]",h=>{h&&ajaxify.go(u)})}throw g}}async function C(c){const{url:y}=c;delete c.url,c.data&&!(c.data instanceof FormData)&&(c.data=JSON.stringify(c.data||{}),c.headers["content-type"]="application/json; charset=utf-8"),{options:c}=await(0,R.fire)("filter:api.options",{options:c}),c.data&&(c.body=c.data,delete c.data);const g=await fetch(y,c),{headers:u}=g;if(u.get("x-redirect"))return C({url:u.get("x-redirect"),...c});const h=u.get("content-type"),w=h&&h.startsWith("application/json");let p;if(c.method!=="HEAD"&&(w?p=await g.json():p=await g.text()),!g.ok)throw p?new Error(w?p.status.message:p):new Error(g.statusText);return w&&p&&p.hasOwnProperty("status")&&p.hasOwnProperty("response")?p.response:p}function x(c,y,g){return b({url:c+(y&&Object.keys(y).length?"?"+$.param(y):"")},g)}function E(c,y,g){return b({url:c+(y&&Object.keys(y).length?"?"+$.param(y):""),method:"HEAD"},g)}function l(c,y,g){return b({url:c,method:"POST",data:y,headers:{"x-csrf-token":config.csrf_token}},g)}function m(c,y,g){return b({url:c,method:"PATCH",data:y,headers:{"x-csrf-token":config.csrf_token}},g)}function U(c,y,g){return b({url:c,method:"PUT",data:y,headers:{"x-csrf-token":config.csrf_token}},g)}function T(c,y,g){return b({url:c,method:"DELETE",data:y,headers:{"x-csrf-token":config.csrf_token}},g)}})}]);
